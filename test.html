<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¡å—åŒ–æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>æ¨¡å—åŒ–ç»“æ„æµ‹è¯•</h1>
        
        <div class="test-section">
            <h3>1. æ•°æ®æ¨¡å—æµ‹è¯•</h3>
            <button class="test-button" onclick="testDataModule()">æµ‹è¯•æ•°æ®æ¨¡å—</button>
            <div id="data-log" class="log"></div>
        </div>
        
        <div class="test-section">
            <h3>2. UIæ§åˆ¶å™¨æµ‹è¯•</h3>
            <button class="test-button" onclick="testUIController()">æµ‹è¯•UIæ§åˆ¶å™¨</button>
            <div id="ui-log" class="log"></div>
        </div>
        
        <div class="test-section">
            <h3>3. è§†é¢‘æ’­æ”¾å™¨æµ‹è¯•</h3>
            <button class="test-button" onclick="testVideoPlayer()">æµ‹è¯•è§†é¢‘æ’­æ”¾å™¨</button>
            <div id="video-log" class="log"></div>
        </div>
        
        <div class="test-section">
            <h3>4. åº”ç”¨é›†æˆæµ‹è¯•</h3>
            <button class="test-button" onclick="testAppIntegration()">æµ‹è¯•åº”ç”¨é›†æˆ</button>
            <div id="app-log" class="log"></div>
        </div>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://cdnjs.cloudflare.com/ajax/libs/three.js/0.174.0/three.module.js",
                "@sparkjsdev/spark": "https://sparkjs.dev/releases/spark/0.1.8/spark.module.js"
            }
        }
    </script>

    <script type="module">
        import { videoMap, modelMap, sceneObjects, objectImages } from './js/data.js';
        import { UIController } from './js/ui-controller.js';
        import { VideoPlayer } from './js/video-player.js';
        import { App } from './js/app.js';

        window.testDataModule = function() {
            const log = document.getElementById('data-log');
            log.innerHTML = '';
            
            try {
                log.innerHTML += 'âœ… æ•°æ®æ¨¡å—åŠ è½½æˆåŠŸ\n';
                log.innerHTML += `ğŸ“Š è§†é¢‘æ˜ å°„: ${Object.keys(videoMap).length} ä¸ªåœºæ™¯\n`;
                log.innerHTML += `ğŸ® æ¨¡å‹æ˜ å°„: ${Object.keys(modelMap).length} ä¸ªåœºæ™¯\n`;
                log.innerHTML += `ğŸ—ï¸ åœºæ™¯ç‰©ä½“: ${Object.keys(sceneObjects).length} ä¸ªåœºæ™¯\n`;
                log.innerHTML += `ğŸ–¼ï¸ ç‰©ä½“å›¾ç‰‡: ${Object.keys(objectImages).length} ä¸ªç‰©ä½“\n`;
            } catch (error) {
                log.innerHTML += `âŒ æ•°æ®æ¨¡å—æµ‹è¯•å¤±è´¥: ${error.message}\n`;
            }
        };

        window.testUIController = function() {
            const log = document.getElementById('ui-log');
            log.innerHTML = '';
            
            try {
                const uiController = new UIController();
                log.innerHTML += 'âœ… UIæ§åˆ¶å™¨åˆ›å»ºæˆåŠŸ\n';
                log.innerHTML += `ğŸ”§ åˆå§‹åŒ–çŠ¶æ€: ${uiController.isInitialized}\n`;
                log.innerHTML += `ğŸ¯ é€‰ä¸­åœºæ™¯: ${uiController.getSelectedScene() || 'æ— '}\n`;
                log.innerHTML += `ğŸ“¦ é€‰ä¸­ç‰©ä½“: ${uiController.getSelectedObjects().length} ä¸ª\n`;
            } catch (error) {
                log.innerHTML += `âŒ UIæ§åˆ¶å™¨æµ‹è¯•å¤±è´¥: ${error.message}\n`;
            }
        };

        window.testVideoPlayer = function() {
            const log = document.getElementById('video-log');
            log.innerHTML = '';
            
            try {
                const videoPlayer = new VideoPlayer();
                log.innerHTML += 'âœ… è§†é¢‘æ’­æ”¾å™¨åˆ›å»ºæˆåŠŸ\n';
                log.innerHTML += `ğŸ”§ åˆå§‹åŒ–çŠ¶æ€: ${videoPlayer.isInitialized}\n`;
                log.innerHTML += `ğŸ“¹ è§†é¢‘å¯¹è±¡: ${Object.keys(videoPlayer.videos).length} ä¸ª\n`;
            } catch (error) {
                log.innerHTML += `âŒ è§†é¢‘æ’­æ”¾å™¨æµ‹è¯•å¤±è´¥: ${error.message}\n`;
            }
        };

        window.testAppIntegration = function() {
            const log = document.getElementById('app-log');
            log.innerHTML = '';
            
            try {
                const app = new App();
                log.innerHTML += 'âœ… åº”ç”¨ç¨‹åºåˆ›å»ºæˆåŠŸ\n';
                log.innerHTML += `ğŸ”§ åˆå§‹åŒ–çŠ¶æ€: ${app.isInitialized}\n`;
                log.innerHTML += `ğŸ® 3DæŸ¥çœ‹å™¨: ${app.threeViewer ? 'å·²åˆ›å»º' : 'æœªåˆ›å»º'}\n`;
                log.innerHTML += `ğŸ“¹ è§†é¢‘æ’­æ”¾å™¨: ${app.videoPlayer ? 'å·²åˆ›å»º' : 'æœªåˆ›å»º'}\n`;
                log.innerHTML += `ğŸ¯ UIæ§åˆ¶å™¨: ${app.uiController ? 'å·²åˆ›å»º' : 'æœªåˆ›å»º'}\n`;
            } catch (error) {
                log.innerHTML += `âŒ åº”ç”¨é›†æˆæµ‹è¯•å¤±è´¥: ${error.message}\n`;
            }
        };

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•
        document.addEventListener('DOMContentLoaded', () => {
            console.log('æ¨¡å—åŒ–æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            setTimeout(() => {
                testDataModule();
                testUIController();
                testVideoPlayer();
                testAppIntegration();
            }, 1000);
        });
    </script>
</body>
</html> 